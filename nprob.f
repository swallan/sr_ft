C    
    SUBROUTINE NPROB(Z,P,Q,PDF)
    IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
C       P, Q = PROBABILITIES TO THE LEFT AND RIGHT OF Z
C       FOR THE STANDARD NORMAL DISTRIBUTION.
C       PDF  = THE PROBABILITY DENSITY FUNCTION
C
C       REFERENCE: ADAMS,A.G. AREAS UNDER THE NORMAL CURVE,
C       ALGORITHM 39, COMPUTER J., VOL. 12, 197-8, 1969.
C
C       LATEST REVISION - 23 JANUARY 1981
C
C********************************************************************
C
    DATA A0,A1,A2,A3,A4,A5,A6,A7/0.5D0, 0.398942280444D0,
    1  0.399903438504D0, 5.75885480458D0, 29.8213557808D0,
    2  2.62433121679D0, 48.6959930692D0, 5.92885724438D0/,
    3  B0,B1,B2,B3,B4,B5,B6,B7,B8,B9,B10,B11/0.398942280385D0,
    4  3.8052D-8, 1.00000615302D0, 3.98064794D-4, 1.98615381364D0,
    5  0.151679116635D0, 5.29330324926D0, 4.8385912808D0,
    6  15.1508972451D0, 0.742380924027D0, 30.789933034D0,
    7  3.99019417011D0/
C
    ZABS = ABS(Z)
    IF(ZABS.GT.12.7D0) GO TO 20
    Y = A0*Z*Z
    PDF = EXP(-Y)*B0
    IF(ZABS.GT.1.28D0) GO TO 10
C
C       Z BETWEEN -1.28 AND +1.28
C
    Q = A0-ZABS*(A1-A2*Y/(Y+A3-A4/(Y+A5+A6/(Y+A7))))
    IF(Z.LT.0.D0) GO TO 30
    P = 1.D0-Q
    RETURN
C
C       ZABS BETWEEN 1.28 AND 12.7
C
   10 Q = PDF/(ZABS-B1+B2/(ZABS+B3+B4/(ZABS-B5+B6/(ZABS+B7-B8/
    1  (ZABS+B9+B10/(ZABS+B11))))))
    IF(Z.LT.0.D0) GO TO 30
    P = 1.D0-Q
    RETURN
C
C       Z FAR OUT IN TAIL
C
  20   Q = 0.D0
    PDF = 0.D0
    IF (Z.LT.0.D0) GO TO 30
    P = 1.D0
    RETURN
C
C       NEGATIVE Z, INTERCHANGE P AND Q
C
30   P = Q
    Q = 1.D0-P
    RETURN
    END